{% extends "base.html" %}
{% load static %}

{% block content %}
<!-- üîç Quick Search -->
<div class="mb-4">
    <form method="get" class="row g-2">
        <div class="col-md-3">
            <select name="field" class="form-select">
                <option value="">-- Search in all fields --</option>
                <option value="title" {% if request.GET.field == "title" %}selected{% endif %}>Title</option>
                <option value="description" {% if request.GET.field == "description" %}selected{% endif %}>Description</option>
                <option value="instructor" {% if request.GET.field == "instructor" %}selected{% endif %}>Instructor</option>
            </select>
        </div>
        <div class="col-md-6">
            <input type="text" name="search" value="{{ request.GET.search }}" placeholder="Enter keyword..." class="form-control">
        </div>
        <div class="col-md-3">
            <button type="submit" class="btn btn-primary w-100">Search</button>
        </div>
    </form>
</div>

<!-- Hero Section -->
<div class="text-center py-5 bg-light rounded">
    <h1 class="fw-bold">Learn Anytime, Anywhere</h1>
    <p class="lead">Develop new skills with our online courses</p>
</div>

<!-- Featured Courses -->
<div class="d-flex justify-content-between align-items-center mt-5">
    <h2 class="mb-0">Featured Courses</h2>

    {% if user.is_authenticated and user.groups.all.0.name == "instructor" %}
        <!-- ‚úÖ instructor ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏ô‡∏µ‡πâ -->
        <a href="{% url 'course:add_course' %}" class="btn btn-success">‚ûï Add Course</a>
    {% endif %}
</div>

<!-- Courses Grid -->
<div class="row mt-3">
    {% for course in courses %}
        <div class="col-md-3">
            <div class="card mb-4 shadow-sm h-100">
                {% if course.thumbnail %}
                    <img src="{{ course.thumbnail.url }}" class="card-img-top" alt="{{ course.title }}">
                {% else %}
                    <img src="{% static 'images/python.png' %}" class="card-img-top" alt="default image">
                {% endif %}
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">{{ course.title }}</h5>
                    <p class="card-text">{{ course.description|truncatewords:20 }}</p>

                    <p class="mb-1">üìö {{ course.lesson_count }} lessons</p>
                    <p class="mb-2">üë©‚Äçüéì {{ course.student_count }} students</p>

                    <p class="fw-bold text-success">‡∏ø{{ course.price }}</p>

                    <div class="mt-auto d-flex gap-2">
                        {% if user.is_authenticated %}
                            {% if user.groups.all.0.name == "instructor" %}
                                <!-- üë®‚Äçüè´ instructor ‡πÄ‡∏´‡πá‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏•‡∏ö -->
                                <a href="{% url 'course:edit_course' course.id %}" class="btn btn-warning btn-sm flex-fill">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</a>

                                <!-- üóëÔ∏è ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö‡∏Ñ‡∏≠‡∏£‡πå‡∏™ -->
                                <form method="post" action="{% url 'course:delete_course' course.id %}" class="flex-fill">
                                    {% csrf_token %}
                                    <button type="submit" class="btn btn-danger btn-sm w-100"
                                            onclick="return confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏ô‡∏µ‡πâ?');">
                                        ‡∏•‡∏ö
                                    </button>
                                </form>
                            {% endif %}

                            <!-- ‚úÖ ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÄ‡∏´‡πá‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î -->
                            <a href="{% url 'course:course_detail' course.id %}" class="btn btn-primary btn-sm flex-fill">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</a>
                        {% else %}
                            <!-- ‚ùå guest ‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏Ñ‡πà‡∏õ‡∏∏‡πà‡∏°‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô -->
                            <a href="{% url 'authen:login' %}" class="btn btn-outline-secondary btn-sm w-100">
                                ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
                            </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    {% empty %}
        <p>No courses available.</p>
    {% endfor %}
</div>

<!-- Why Choose Us Section -->
<section class="py-5 bg-light">
    <div class="container">
        <h2 class="fw-bold text-center mb-5">Why Choose Us</h2>
        <div class="row g-4">
            <!-- Card 1 -->
            <div class="col-md-3">
                <div class="card h-100 shadow-sm text-center border-0">
                    <div class="card-body">
                        <img src="{% static 'images/teacher.png' %}" alt="Expert Instructors" width="70" class="mb-3">
                        <h5 class="card-title fw-bold">Expert Instructors</h5>
                        <p class="card-text text-muted">Learn from industry experts with years of experience.</p>
                    </div>
                </div>
            </div>
            <!-- Card 2 -->
            <div class="col-md-3">
                <div class="card h-100 shadow-sm text-center border-0">
                    <div class="card-body">
                        <img src="{% static 'images/flexibility.png' %}" alt="Flexible Learning" width="70" class="mb-3">
                        <h5 class="card-title fw-bold">Flexible Learning</h5>
                        <p class="card-text text-muted">Study anytime, anywhere at your own pace.</p>
                    </div>
                </div>
            </div>
            <!-- Card 3 -->
            <div class="col-md-3">
                <div class="card h-100 shadow-sm text-center border-0">
                    <div class="card-body">
                        <img src="{% static 'images/certificate.png' %}" alt="Certification" width="70" class="mb-3">
                        <h5 class="card-title fw-bold">Certification</h5>
                        <p class="card-text text-muted">Receive recognized certificates upon completion.</p>
                    </div>
                </div>
            </div>
            <!-- Card 4 -->
            <div class="col-md-3">
                <div class="card h-100 shadow-sm text-center border-0">
                    <div class="card-body">
                        <img src="{% static 'images/support.png' %}" alt="Support" width="70" class="mb-3">
                        <h5 class="card-title fw-bold">24/7 Support</h5>
                        <p class="card-text text-muted">Get guidance and support whenever you need it.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
