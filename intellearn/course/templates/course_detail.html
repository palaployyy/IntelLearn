{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container py-5">
    <!-- Course Header -->
    <div class="row mb-4">
        <div class="col-md-8">
            <h2 class="fw-bold">{{ course.title }}</h2>
            <p class="text-muted">ğŸ‘¨â€ğŸ« Instructor: {{ course.instructor }}</p>

            {% if course.thumbnail_url %}
                <img src="{{ course.thumbnail_url }}" class="img-fluid rounded mb-3" alt="{{ course.title }}">
            {% endif %}

            <p>{{ course.description }}</p>

            <p class="fw-bold text-success">ğŸ’² à¸¿{{ course.price }}</p>

            <p>
                ğŸ“š {{ lessons.count }} lessons <br>
                ğŸ‘©â€ğŸ“ {{ students_count }} students
            </p>

            <!-- âœ… à¸›à¸¸à¹ˆà¸¡ Enroll -->
            {% if user.is_authenticated %}
                {% if is_enrolled %}
                    <button class="btn btn-secondary w-100 mb-3" disabled>
                        âœ… Already Enrolled
                    </button>
                {% else %}
                    <form method="post">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-success w-100 mb-3">
                            ğŸ“š Enroll in this Course
                        </button>
                    </form>
                {% endif %}
            {% else %}
                <a href="{% url 'login' %}" class="btn btn-primary w-100 mb-3">
                    ğŸ”‘ Login to Enroll
                </a>
            {% endif %}
        </div>
    </div>

    <hr>

    <!-- Lessons List -->
    <h4 class="mt-4">Course Lessons</h4>
    <ul class="list-group">
        {% for lesson in lessons %}
            <li class="list-group-item">
                <strong>{{ lesson.order }}. {{ lesson.title }}</strong>
                {% if lesson.video_url %}
                    <a href="{{ lesson.video_url }}" target="_blank" class="btn btn-sm btn-outline-primary float-end">
                        â–¶ Watch Video
                    </a>
                {% endif %}
                <p class="mb-0 text-muted">{{ lesson.content|truncatewords:20 }}</p>
            </li>
        {% empty %}
            <li class="list-group-item">No lessons available yet.</li>
        {% endfor %}
    </ul>
</div>
{% endblock %}
