{% extends "base.html" %}
{% block title %}‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô{% endblock %}

{% block content %}
<div class="container">
  <h3 class="mb-3">üìà ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</h3>

  {% if enrollments %}
    <div class="row g-3">
      {% for en in enrollments %}
        {% with prog=en.progress total=en.course.lessons.count done=en.progress.completed_lessons.count pct=prog.percentage %}
        <div class="col-md-6">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start">
                <div>
                  <h5 class="mb-1">{{ en.course.title }}</h5>
                  <div class="text-muted small">‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: {{ total }} | ‡∏ó‡∏≥‡πÅ‡∏•‡πâ‡∏ß: {{ done }}</div>
                </div>
                <a class="btn btn-sm btn-outline-primary"
                   href="{% url 'course:course_detail' en.course.id %}">
                  ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏≠‡∏£‡πå‡∏™
                </a>
              </div>

              <div class="mt-3">
                <div class="progress" style="height: 12px;">
                  <div class="progress-bar bg-success" role="progressbar"
                       style="width: {{ pct }}%;" aria-valuenow="{{ pct }}" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <div class="d-flex justify-content-between mt-1">
                  <span class="text-muted small">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</span>
                  <span class="fw-semibold">{{ pct }}%</span>
                </div>
              </div>

              {% if prog.last_accessed %}
                <div class="text-muted small mt-2">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: {{ prog.last_accessed|date:"Y-m-d H:i" }}</div>
              {% endif %}
            </div>
          </div>
        </div>
        {% endwith %}
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-info">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</div>
  {% endif %}
</div>
{% endblock %}
